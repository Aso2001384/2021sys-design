```uml
@startuml
ユーザー -> Webサーバー : 商品クリック
Webサーバー -> ユーザー : 商品詳細画面を表示
opt 商品購入

ユーザー -> Webサーバー : カートに入れるをクリック
Webサーバー -> DBサーバー : 商品情報送信
DBサーバー -> DBサーバー : 在庫確認

alt 在庫がある

DBサーバー -> DBサーバー : カート内更新
DBサーバー -> Webサーバー : 結果送信
Webサーバー -> ユーザー : カート内画面を表示
ユーザー -> Webサーバー : 商品購入をクリック
Webサーバー -> ユーザー : 支払い画面を表示
ユーザー -> Webサーバー : 支払い確認
Webサーバー -> DBサーバー : 購入情報送信
DBサーバー -> DBサーバー : 決済処理
DBサーバー -> Webサーバー : 結果送信
alt 支払い完了

Webサーバー -> ユーザー : 決済完了画面を表示
else エラーが発生
Webサーバー -> ユーザー : エラー画面を表示
end

else 在庫がない
DBサーバー -> Webサーバー : 結果送信
Webサーバー -> ユーザー : 在庫がないと表示

end
@enduml
```
